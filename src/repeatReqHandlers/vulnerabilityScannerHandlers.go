package repeatReqHandlers

import (
	"net/http"
	"strings"

	"github.com/sirupsen/logrus"
)

var tokens = []string{
	";cat /etc/passwd;",
	"|cat /etc/passwd|",
	"`cat /etc/passwd`",
}

func TryVulnerabilities(respWriter http.ResponseWriter, request *http.Request) {
	req := getReqFromParam(respWriter, request)
	// logrus.Debug(req.Request)
	if req.Request[:3] == "GET" {
		logrus.Debug("Trying GET request vulnerability")
		// params := findGETParams(req.Request)
	} else if req.Request[:4] == "POST" {
		logrus.Debug("Trying POST request vulnerability")
		params := findPOSTParams(req.Request)
		for _, param := range params {
			for _, token := range tokens {
				logrus.Info(strings.Replace(req.Request, param.serialize(), param.fakeReplaceValue(token), 1))
			}
		}
	}
}
